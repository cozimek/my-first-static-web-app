<html>
	
	<head>
	
		<!-- Microsoft Teams JavaScript API (via CDN) -->
		<script src="https://statics.teams.cdn.office.net/sdk/v1.9.0/js/MicrosoftTeams.min.js" integrity="sha384-bcRxWKfzRyPxg/waVm3IsOnaH2Inoh5gGIJNOat79+wq22/BZ+mFuSTUmVc7l2el" crossorigin="anonymous"></script>
		<link rel="stylesheet" href="https://static2.sharepointonline.com/files/fabric/office-ui-fabric-core/11.0.0/css/fabric.min.css" />
	</head>
	
	<body>
	
		<form style="text-align: center;" class="form-inline" id="form_login">
	
			<div>
				<p style="color: #6264a7;" class="ms-fontSize-20">Microsoft Teams Embed URL</p>
				<div class="ms-TextField">
					<input style="height: 36px; width: 300px; color: #6264a7;" class="ms-TextField-field" type="text" id="urlText" name="urlText" />   
					<label>Microsoft Teams Embed URL</label>
				</div>
			</div>  
 	
 			<div>
				<p>Approve URL for Publishing in Teams</p>
				<input style="height: 36px; width: 36px;" type="checkbox" id="okay" name="okay" value="ok" onclick="onClick()"/>	
				<label id="warning">Please check the box</label>
			</div>
	
		</form>
	
		<script type="text/javascript">
			
			microsoftTeams.initialize();
			microsoftTeams.settings.setValidityState(true);

			function onClick() {
				
				microsoftTeams.settings.setValidityState(true);
				
				var d = document.getElementById("warning");
				
				if (d.style.display === "none") {
					d.style.display = "block";
				} else {
					d.style.display = "none";
				}
				
				var b = document.getElementById("urlText").value;
				
				if(b=="") {
					alert("Please enter URL");
					document.getElementById("okay").checked = false; 
					document.getElementById("warning").style.display = "block";
					return;
				}
				
				microsoftTeams.settings.registerOnSaveHandler(function(saveEvent){
					
					microsoftTeams.settings.setValidityState(true);
					var btn = document.getElementsByName("okay");
					
					var x = document.getElementById("urlText").value;
					
					if (x.indexOf('https') === -1) {
						if (x.indexOf('http') > -1){
							x = x.replace('http', 'https');
						} else {
							x = "https://".concat(x);
						}
 					}
 					
 					if (b!="") {
						microsoftTeams.settings.setSettings({
							entityId: "soapboxengage123456789",
							contentUrl: x,
							suggestedDisplayName: "Soapbox Engage",
							//websiteUrl: "https://mango-flower-04dd94f10.azurestaticapps.net/soapboxengageteamsappconfiguration.html",
							//removeUrl: "https://mango-flower-04dd94f10.azurestaticapps.net/soapboxengageteamsappconfiguration.html",
						});
					}
					saveEvent.notifySuccess();
					//microsoftTeams.appInitialization.notifySuccess()
				});
			}
			
			function onSub() {
			
				microsoftTeams.settings.setValidityState(true);
			
				alert("DFsf");
			
				microsoftTeams.settings.registerOnSaveHandler(function(saveEvent){
					microsoftTeams.settings.setValidityState(true);
					var btn = document.getElementsByName("okay");
					var x = document.getElementById("urlText").value;
					alert(x);
			
					microsoftTeams.settings.setSettings({
						entityId: "soapboxengage1234",
						contentUrl: x,
						suggestedDisplayName: "Soapbox Engage",
						//websiteUrl: "https://mango-flower-04dd94f10.azurestaticapps.net/soapboxengageteamsappconfiguration.html",
						//removeUrl: "https://mango-flower-04dd94f10.azurestaticapps.net/soapboxengageteamsappconfiguration.html",
					});
			
					saveEvent.notifySuccess();
					//microsoftTeams.appInitialization.notifySuccess();
			
				});
			
			}
		
		</script>

		<style>

			div {
				clear: both;
				float: left;
				padding-top: 0.5em;
    		}
    
    		input {
        		display:block;
    		}
    
    		label {
    			float: right;
    			color: white;
    		}

			html,body {
				height: 100%;
				width: 100%;
				margin: 0;
			}

			body {
				display: flex;
			}

			form {
  				margin: auto;/* nice thing of auto margin if display:flex; it center both horizontal and vertical :) */
			}
		
		</style>
  
	</body>

</html>
